<?php
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ---																																						---
/** --- 											----------------------------------------------- 											---
/** --- 													{ M Y S Q L . C L A S S . P H P }														---
/** --- 											----------------------------------------------- 											---
/** ---																																						---
/** ---		AUTEUR 	: Neoblaster																													---
/** ---																																						---
/** ---		RELEASE	: 27.03.2015																													---
/** ---																																						---
/** ---		VERSION	: 1.0																																---
/** ---																																						---
/** ---																																						---
/** --- 														-----------------------------															---
/** --- 															 { C H A N G E L O G } 																---
/** --- 														-----------------------------															---
/** ---																																						---
/** ---		VERSION 1.0 : 27.03.2015																												---
/** ---		-------------------------																												---
/** ---			- Première release																													---
/** ---																																						---
/** --- 										-----------------------------------------------------											---
/** --- 											{ L I S T E      D E S      M E T H O D E S } 												---
/** --- 										-----------------------------------------------------											---
/** ---																																						---
/** ---		GETTERS :																																	---
/** ---	    ---------																																	---
/** ---																																						---
/** ---			- [Pub] account																														---
/** ---			- [Pub] table																															---
/** ---																																						---
/** ---		SETTERS :																																	---
/** ---	    ---------																																	---
/** ---																																						---
/** ---			- [Pub] add_account																													---
/** ---			- [Pub] use_account																													---
/** ---																																						---
/** ---		OUTPUTTERS :																																---
/** ---	    ------------																																---
/** ---																																						---
/** ---		WORKERS :																																	---
/** ---	    ---------																																	---
/** ---																																						---
/** ---			- [Pub] connect																														---
/** ---			- [Pub] disconnect																													---
/** ---																																						---
/** ---																																						---
/** -----------------------------------------------------------------------------------------------------------------------
/** ----------------------------------------------------------------------------------------------------------------------- **/
class MySQL {
/** -----------------------------------------------------------------------------------------------------------------------
/** -----------------------------------------------------------------------------------------------------------------------
/** ---																																						---
/** ---															{ P R O P E R T I E S }																---
/** ---																																						---
/** -----------------------------------------------------------------------------------------------------------------------
/** ----------------------------------------------------------------------------------------------------------------------- **/
	protected $_accounts = Array();	// Liste des compte SQL enregistré avec (Serveur, User, Password and Tables)
	protected $_use_account = null;	// Compte à utiliser lors de la connection SQL
	protected $_tables;					// Table disponible pour le compte en cours d'utilisation
	protected $_connection;				// Stocke l'instance de connection SQL
	
/** ----------------------------------------------------------------------------------------------------------------------- 
/** -----------------------------------------------------------------------------------------------------------------------
/** ---																																						---
/** ---														{ C O N S T R U C T E U R S }															---
/** ---																																						---
/** -----------------------------------------------------------------------------------------------------------------------
/** ----------------------------------------------------------------------------------------------------------------------- **/
	
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ---																																						---
/** ---																{ G E T T E R S }																	---
/** ---																																						---
/** -----------------------------------------------------------------------------------------------------------------------
/** ----------------------------------------------------------------------------------------------------------------------- **/
	
	/****************************************************************
	/** Methode qui retourne l'instance Account passé en paramètre **
	/****************************************************************/
	public function account($account_name){
		return $this->_accounts[$account_name];
	}
	
	/*************************************************
	/** Methode qui permet un accès vers les tables **
	/*************************************************/
	public function table($index){
		return $this->_tables[$index];
	}
	
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ---																																						---
/** ---																{ S E T T E R S }																	---
/** ---																																						---
/** -----------------------------------------------------------------------------------------------------------------------
/** ----------------------------------------------------------------------------------------------------------------------- **/
	
	/*****************************************
	/** Fonction pour ajouter un compte SQL **
	/*****************************************/
	public function add_account($account_name){
		/** Vérifier que le compte n'existe pas déjà **/
		if(!array_key_exists($account_name, $this->_accounts)){
			$this->_accounts[$account_name] = new Account();
		} else {
			die("MySQL->add_account() failed; The account '$account_name' already exist.");
		}
	}
	
	/*********************************************************
	/** Spécifie le compte à utiliser lors de la connection **
	/*********************************************************/
	public function use_account($account){
		$this->_use_account = $account;
	}
	
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ---																																						---
/** ---															{ O U T P U T E R S }																---
/** ---																																						---
/** -----------------------------------------------------------------------------------------------------------------------
/** ----------------------------------------------------------------------------------------------------------------------- **/
	
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ---																																						---
/** ---																{ W O R K E R S }																	---
/** ---																																						---
/** -----------------------------------------------------------------------------------------------------------------------
/** ----------------------------------------------------------------------------------------------------------------------- **/

	/*********************************
	/** Declencher la connexion SQL **
	/*********************************/
	public function connect(){
		if($this->_use_account !== null){
			$this->_connection = mysql_connect($this->account($this->_use_account)->get('host'), $this->account($this->_use_account)->get('user'), $this->account($this->_use_account)->get('password'));
			mysql_select_db($this->account($this->_use_account)->get('database'));
			$this->_tables = $this->account($this->_use_account)->get('tables');
		} else{
			die("MySQL->connect() failed; You haven't specified which SQL account to use");
		}
	}
	
	/***********************************
	/** Declencher la déconnexion SQL **
	/***********************************/
	public function disconnect(){
		if(gettype($this->_connection) == 'resource'){
			mysql_close();
			$this->_connection = null;
		} else{
			die('MySQL->disconnect() failed; There is no active SQL connection to close.');
		}
	}
	
}






/** ----------------------------------------------------------------------------------------------------------------------- 
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ---																																						---
/** --- 											-----------------------------------------------------										---
/** --- 												{ L I S T E      D E S      M E T H O D E S } 											---
/** --- 											-----------------------------------------------------										---
/** ---																																						---
/** ---		GETTERS :																																	---
/** ---	    ---------																																	---
/** ---																																						---
/** ---			- [Pub] get																																---
/** ---																																						---
/** ---		SETTERS :																																	---
/** ---	    ---------																																	---
/** ---																																						---
/** ---			- [Pub] set_credentials																												---
/** ---			- [Pub] set_database																													---
/** ---			- [Pub] set_host																														---
/** ---			- [Pub] set_tables																													---
/** ---																																						---
/** ---		OUTPUTTERS :																																---
/** ---	    ------------																																---
/** ---																																						---
/** ---		WORKERS :																																	---
/** ---	    ---------																																	---
/** ---																																						---
/** -----------------------------------------------------------------------------------------------------------------------
/** ----------------------------------------------------------------------------------------------------------------------- **/
class Account{
/** -----------------------------------------------------------------------------------------------------------------------
/** -----------------------------------------------------------------------------------------------------------------------
/** ---																																						---
/** ---															{ P R O P E R T I E S }																---
/** ---																																						---
/** -----------------------------------------------------------------------------------------------------------------------
/** ----------------------------------------------------------------------------------------------------------------------- **/
	protected $_database;	// Base de données à utiliser sur le serveur
	protected $_host;			// Serveur Cible
	protected $_password;	// Mot de passe de connection
	protected $_user;			// Identifiant utilisateur
	protected $_tables;		// Liste des tables utilisable
	
/** ----------------------------------------------------------------------------------------------------------------------- 
/** -----------------------------------------------------------------------------------------------------------------------
/** ---																																						---
/** ---														{ C O N S T R U C T E U R S }															---
/** ---																																						---
/** -----------------------------------------------------------------------------------------------------------------------
/** ----------------------------------------------------------------------------------------------------------------------- **/
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ---																																						---
/** ---																{ G E T T E R S }																	---
/** ---																																						---
/** -----------------------------------------------------------------------------------------------------------------------
/** ----------------------------------------------------------------------------------------------------------------------- **/
	
	/*********************************************************
	/** Fonction qui retourne la donnée passé en paramètres **
	/*********************************************************/
	public function get($data){
		switch($data){
			case 'database':
				return $this->_database;
			break;
			case 'host':
				return $this->_host;
			break;
			case 'password':
				return $this->_password;
			break;
			case 'user':
				return $this->_user;
			break;
			case 'tables':
				return $this->_tables;
			break;
			default:
				die("Account->get() failed; The request data doesn't not exsts");
			break;
		}
	}
		
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ---																																						---
/** ---																{ S E T T E R S }																	---
/** ---																																						---
/** -----------------------------------------------------------------------------------------------------------------------
/** ----------------------------------------------------------------------------------------------------------------------- **/
	
	/****************************************************
	/** Définition des crédentials relatifs au serveur **
	/****************************************************/
	public function set_credentials($user, $password){
		$this->_user = $user;
		$this->_password = $password;
	}
	
	/***************************************************************
	/** Définition de la base de donnée à utiliser sur le serveur **
	/***************************************************************/
	public function set_database($database){
		$this->_database = $database;
	}
	
	/*********************************
	/** Définition du serveur cible **
	/*********************************/
	public function set_host($host){
		$this->_host = $host;
	}	
	
	/**********************************************************************
	/** Définition du scope du compte pour son accès au table de la base **
	/**********************************************************************/
	public function set_tables(){
		$this->_tables = func_get_args();
	}
	
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ---																																						---
/** ---															{ O U T P U T E R S }																---
/** ---																																						---
/** -----------------------------------------------------------------------------------------------------------------------
/** ----------------------------------------------------------------------------------------------------------------------- **/
	
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ----------------------------------------------------------------------------------------------------------------------- 
/** ---																																						---
/** ---																{ W O R K E R S }																	---
/** ---																																						---
/** -----------------------------------------------------------------------------------------------------------------------
/** ----------------------------------------------------------------------------------------------------------------------- **/
}

?>